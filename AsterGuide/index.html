<!DOCTYPE html>
<head>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
<script src="http://d3js.org/d3.v3.min.js"></script>
<script>
    var data;
    $(document).ready(function(){
        $.getJSON('aster_functions.json', function(response){
            data = response;
        });
    });
    /*
    names = [];
    for (i=0; i < mydata['children'].length; i++){
        for (j=0; j < mydata['children'][i]['children'].length; j++){
            names.push(mydata['children'][i]['children'][j].name);
        }
    };
    */
   
</script>


<style>

    h4 {
        color:#173E6E;
    }

    body {
        background-image:url("noisy-texture.png");
    }
    .node {
      cursor: pointer;
    }
    .node circle {
      fill: #FF6E00;
      stroke: #FF6E00;
      stroke-width: 1.5px;
    }
    .node text {
      font: 11px sans-serif;
    }
    .link {
      fill: none;
      stroke: #ccc;
      stroke-width: 1.5px;
    }
</style>

</head>
<body>
    <div class="row">
        <div class="col-md-12">
            <h2 class="text-center"><span style="color:#FF6E00">Teradata Aster</span> Functions Guide</h2>
        </div>
        <div class="col-md-6" id="chart"></div>
        <div class="col-md-6" id="function_text">
            <div id="Attribution" style="display:none">
                <h2 class="text-center">Attribution</h2>
                <h4>Summary</h4>
                <p>
                    The attribution operator is often used in web page analysis. Companies would like to assign weights to pages before certain events, such as a 'click' or a 'buy'. This attribution function enables you to calculate attributions by using a wide range of distribution models.</p>
                <p>
                    There are two different ways to call the attribution SQL-MR function, depending on how many inputs you are using. The multiple input and the single input function calls use very different syntax, so they are documented separately:
                </p>
                <h4>Usage</h4>
                <ul class="nav nav-tabs" role="tablist">
                    <li class="active"><a href="#multiple_attribution" role="tab" data-toggle="tab">Multiple Input</a></li>
                    <li><a href="#single_attribution" role="tab" data-toggle="tab">Single Input</a></li>
                </ul>
                <div class="tab-content">
                    <div class="tab-pane active" id="multiple_attribution">
                        <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
                    </div>
                    <div class="tab-pane" id="single_attribution">
                        <script src="https://gist.github.com/PMeinshausen/f5db870c53700d8217a1.js"></script>
                    </div>
                </div>
            </div>
            <div id="CMAVG" style="display:none">
                <h2 class="text-center">CMAVG</h2>
                <h4>Summary</h4>
                <p>
                    The Cumulative Moving Average (CMAVG) function computes the average of a value from the beginning of a series.
                </p>
                <h4>Background</h4>
                <p>
                    In a cumulative moving average, the data are added to the dataset in an ordered data stream over time. The objective is to compute the average of all the data at each point in time when new data arrived. For example, an investor may want to find the average price of all of the stock transactions for a particular stock over time, up until the current time.
                </p>
                <p>
                    The cumulative moving average computes the arithmetic average of all the rows from the beginning of the series:
                </p>
                <p style="font-family:Latin Modern Mono">
                    new_smavg = sum(a1 ... aN) / N
                </p>
                <p>
                    where N is the number of rows from the beginning of the dataset.
                </p>
                <h4>Usage</h4>
                <script src="https://gist.github.com/PMeinshausen/d7c13e8f7f301a569614.js"></script>
            </div>
            <div id="DTW" style="display:none">
                <h2 class="text-center">DTW</h2>
                <h4>Background</h4>
                <p>
                    Dynamic time warping (DTW) is an algorithm that measures the similarity between two sequences that vary in time or speed.
                </p>
                <p>
                    For example, DTW can detect similarities in walking patterns, even if in one video the person is walking slowly and in another, the same person is walking fast.
                </p>
                <p>
                    DTW has been used to analyze video, audio, and graphics. DTW can be applied to any data that can be represented linearly. One of the applications of DTW is in the field of speech recognition. In this case, DTW can deal with the different speech speeds, which results in better recognition.
                </p>
                <h4>Usage</h4>
                <script src="https://gist.github.com/PMeinshausen/c22f77a7f554ad737ad9.js"></script>
            </div>
            <div id="DWT" style="display:none">
                <h2 class="text-center">DWT</h2>
                <h4>Summary</h4>
                <p>
                    This function implements Mallat’s algorithm which is an iterate algorithm in the Discrete Wavelet Transform (DWT) field, and is designed to apply wavelet transform on multiple sequences simultaneously. The input is typically a set of time series sequences. Each sequence consists of values in a specific order. You specify the wavelet name, transform level, and optionally the extension mode. The result is the transformed sequences in Hilbert space with corresponding component identifier and index. The transformation is also called decomposition.
                </p>
                <p>
                    The result can be filtered to reduce the length of the sequence. And the original sequence can be reconstructed according to the result via IDWT. Thus the function can be adopted in compression and denoise.
                </p>
                <h4>Background</h4>
                <p>
                    DWT is a kind of time-frequency analysis tool for which the wavelets are discretely sampled. DWT is different from the Fourier transform, which provides frequency information on the whole time domain. A key advantage of DWT is that it provides frequency information at different time points.
                </p>
                <p>
                    Mallat’s algorithm can be described as several iterative steps. For example, in the case of a 3- level wavelet transform, the algorithm performs these steps:
                </p>
                <p>
                    <span style="font-weight:bold">1)</span> Use <span style="font-style:italic">S(n)</span> as the original time domain sequence as the input of level 1.<br>
                    <span style="font-weight:bold">2)</span> The input sequence is convolved with high-pass filter <span style="font-style:italic">h(n)</span> and low-pass filter <span style="font-style:italic">g(n)</span>, then the convolved sequences are downsampled respectively.
                    Two sequences are generated. The generated sequences are the detail coefficients <span style="font-style:italic">Dk</span> and the approximation coefficients <span style="font-style:italic">Ak</span> in level <span style="font-style:italic">k</span>.<br>
                    <span style="font-weight:bold">3)</span> If current level <span style="font-style:italic">k</span> reaches max transform level <span style="font-style:italic">n</span>, then go to the end. Otherwise, <span style="font-style:italic">Ak</span> is used as the input sequence for the next level; increase the current level <span style="font-style:italic">k</span> by 1, then go to step 2.
                </p>
                <h4>Usage</h4>
                <script src="https://gist.github.com/PMeinshausen/4a41721519692a9e3ec4.js"></script>
            </div>
            <div id="DWT2D" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="FrequentPaths" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="IDWT" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="IDWT2D" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="Path_Analyzer" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="Path_Generator" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="Path_Start" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="Path_Summarizer" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="SAX" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="Sessionization" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="nPath" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="Approximate Distinct Count" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="Approximate Percentile" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="ConfusionMatrix" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="Correlation" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="Distribution Matching" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="EMAVG" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="Enhanced Histogram Function" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="FMeasure" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="GLM" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="GLMPredict" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="Histogram" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="KNN" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="LARS Functions" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="LinReg" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="Percentile" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="Principal Component Analysis" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="Sample" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="SMAVG" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="Support Vector Machines" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="VWAP" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="WMAVG" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="LDA Functions" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="Levenshtein Distance" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="Naive Bayes Text Classifer" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="Named Entity Recognition" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="nGram" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="PoSTagger" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="Sentenizer" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="Sentiment Extraction Functions" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="TF_IDF" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="Text_Classifer" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="Text_Parser" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="TextChunker" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="TextMorph" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="TextTagging" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="TextTokenizer" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="Canopy" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="KMeans" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="KMeansPlot" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="Minhash" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="Naive Bayes Functions" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="Random Forest Functions" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="Single Decision Tree Functions" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="Basket_Generator" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="CFilter" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="WSRecommender" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="AllPairsShortestPath" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="Betweenness" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="Closeness" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="EigenvectorCentrality" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="LocalClusteringCoefficient" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="LoopyBeliefPropagation" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="nTree" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="PageRank" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="Antiselect" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="Apache Log Parser" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="IdentityMatch" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="IpGeo" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="JSONParser" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="Multicase" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="MurmurHash" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="OutlierFilter" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="PSTParserAFS" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="Pack" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="Pivot" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="Unpack" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="Unpivot" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="XMLParser" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="XMLRelation" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="CfilterViz" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
            <div id="NpathViz" style="display:none">
                <script src="https://gist.github.com/PMeinshausen/ffeac15ed5f289a8d387.js"></script>
            </div>
        </div>
    </div>

<script>    

    var margin = {top: 20, right: 120, bottom: 20, left: 120},
        width = 1280 - margin.right - margin.left,
        height = 900 - margin.top - margin.bottom;

    var i = 0,
        duration = 750,
        root;

    var tree = d3.layout.tree()
        .size([height, width]);

    var diagonal = d3.svg.diagonal()
        .projection(function(d) { return [d.y, d.x]; });

    var svg = d3.select("div#chart").append("svg")
        .attr("width", width + margin.right + margin.left)
        .attr("height", height + margin.top + margin.bottom)
      .append("g")
        .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

    d3.json("aster_functions.json", function(error, flare) {
      root = flare;
      root.x0 = height / 2;
      root.y0 = 0;

      names = [];
      for (i=0; i < root['children'].length; i++){
          for (j=0; j < root['children'][i]['children'].length; j++){
              names.push(root['children'][i]['children'][j].name);
          }
      };
      console.log(names);

      function collapse(d) {
        if (d.children) {
          d._children = d.children;
          d._children.forEach(collapse);
          d.children = null;
        }
      }

      root.children.forEach(collapse);
      update(root);
    });

    d3.select(self.frameElement).style("height", "900px");

    function update(source) {

      var nodes = tree.nodes(root).reverse(),
          links = tree.links(nodes);

      nodes.forEach(function(d) { d.y = d.depth * 180; });

      var node = svg.selectAll("g.node")
          .data(nodes, function(d) { return d.id || (d.id = ++i); });

      var nodeEnter = node.enter().append("g")
          .attr("class", "node")
          .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
          .on("click", click);

      nodeEnter.append("circle")
          .attr("r", 1e-6)
          .style("fill", function(d) { return d._children ? "orange" : "#FF6E00"; });

      nodeEnter.append("text")
          .attr('class', 'node_text')
          .attr("x", function(d) { return d.children || d._children ? -10 : 10; })
          .attr("dy", ".35em")
          .attr("text-anchor", function(d) { return d.children || d._children ? "end" : "start"; })
          .text(function(d) { return d.name; })
          .style("fill-opacity", 1e-6)
          .on('mouseover', function(){
            d3.select(this).style({'text-decoration': 'underline'});
          })
          .on('mouseout', function(){
            d3.select(this).style({'text-decoration': 'none'});
          });
          //.on('click', function(d){ update_info(d); });

      d3.selectAll('.node_text')
          .on('click', function(d){
            console.log("this");
            update_info(d);
      });

      var nodeUpdate = node.transition()
          .duration(duration)
          .attr("transform", function(d) { return "translate(" + d.y + "," + d.x + ")"; });

      nodeUpdate.select("circle")
          .attr("r", 6.0)
          .style("fill", function(d) { return d._children ? "orange" : "#FF6E00"; });

      nodeUpdate.select("text")
          .style("fill-opacity", 1);

      var nodeExit = node.exit().transition()
          .duration(duration)
          .attr("transform", function(d) { return "translate(" + source.y + "," + source.x + ")"; })
          .remove();

      nodeExit.select("circle")
          .attr("r", 1e-6);

      nodeExit.select("text")
          .style("fill-opacity", 1e-6);

      var link = svg.selectAll("path.link")
          .data(links, function(d) { return d.target.id; });

      link.enter().insert("path", "g")
          .attr("class", "link")
          .attr("d", function(d) {
            var o = {x: source.x0, y: source.y0};
            return diagonal({source: o, target: o});
          });

      link.transition()
          .duration(duration)
          .attr("d", diagonal);

      link.exit().transition()
          .duration(duration)
          .attr("d", function(d) {
            var o = {x: source.x, y: source.y};
            return diagonal({source: o, target: o});
          })
          .remove();

      nodes.forEach(function(d) {
        d.x0 = d.x;
        d.y0 = d.y;
      });
    }


    function click(d) {

      if (d.children) {
        d._children = d.children;
        d.children = null;
      } else {
        d.children = d._children;
        d._children = null;
      }
      update(d);
      //update_info(d);
    }

    function show_text(d){
        var ele = document.getElementById('function_text');
        ele.style.display = "block";
    }

    function update_info(d){
        for (i=0; i<names.length; i++){
            var the_id = names[i];
            $(document.getElementById(the_id)).hide();
        }
        
        $(document.getElementById(d.name)).show();
        //$("div[id ="+d.name+"]").show();

    }

</script>



</body>
